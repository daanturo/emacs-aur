From: Daanturo <daanturo@gmail.com>
Date: Wed, 30 Nov 2022 09:03:59 +0000
Subject: [PATCH 1/2] Inhibit lisp compilation for some dictionary generators

---
 lisp/international/ja-dic-cnv.el | 3 ++-
 lisp/international/titdic-cnv.el | 6 +++---
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/lisp/international/ja-dic-cnv.el b/lisp/international/ja-dic-cnv.el
index ec68d8c8046..df70959b19b 100644
--- a/lisp/international/ja-dic-cnv.el
+++ b/lisp/international/ja-dic-cnv.el
@@ -396,7 +396,8 @@ skkdic-convert
 	;; Postfix
 	(with-current-buffer buf
 	  (goto-char (point-max))
-          (generate-lisp-file-trailer ja-dic-filename :compile t)))
+          (generate-lisp-file-trailer
+           ja-dic-filename :compile t :inhibit-native-compile t)))
 
       ;; Save the working buffer.
       (set-buffer buf)
diff --git a/lisp/international/titdic-cnv.el b/lisp/international/titdic-cnv.el
index b942f5fabc2..8996214dcb5 100644
--- a/lisp/international/titdic-cnv.el
+++ b/lisp/international/titdic-cnv.el
@@ -527,7 +527,7 @@ titdic-convert
 	  ;; Process the body part
 	  (tit-process-body)
           (generate-lisp-file-trailer
-           filename :inhibit-provide t :compile t :coding nil))))))
+           filename :inhibit-provide t :compile nil :coding nil))))))
 
 ;;;###autoload
 (defun batch-titdic-convert (&optional force)
@@ -1161,7 +1161,7 @@ miscdic-convert
                 (with-current-buffer dstbuf
                   (funcall converter dicbuf)))))
           (generate-lisp-file-trailer
-           quailfile :inhibit-provide t :compile t :coding nil)))
+           quailfile :inhibit-provide t :compile nil :coding nil)))
       (setq tail (cdr tail)))))
 
 (defun batch-miscdic-convert ()
@@ -1218,7 +1218,7 @@ pinyin-convert
           (forward-line 1)))
       (insert ")\n\"An alist holding correspondences between pinyin syllables\
  and\nChinese characters.\")\n\n")
-      (generate-lisp-file-trailer dst-file :compile t))
+      (generate-lisp-file-trailer dst-file :compile nil))
     (kill-emacs 0)))
 
 ;;; titdic-cnv.el ends here
-- 
2.38.1


From e9e66710d51b76c1d015c1229c8bbc46e635a18b Mon Sep 17 00:00:00 2001
From: Daanturo <daanturo@gmail.com>
Date: Sun, 4 Dec 2022 04:56:04 +0000
Subject: [PATCH 2/2] Inhibit compilation for some non essential lisp files

---
 lisp/cedet/.dir-locals.el    | 4 ++++
 lisp/cedet/data-debug.el     | 4 ++++
 lisp/cedet/mode-local.el     | 4 ++++
 lisp/cedet/pulse.el          | 4 ++++
 lisp/leim/.dir-locals.el     | 4 ++++
 lisp/obsolete/.dir-locals.el | 4 ++++
 lisp/play/.dir-locals.el     | 4 ++++
 7 files changed, 28 insertions(+)
 create mode 100644 lisp/cedet/.dir-locals.el
 create mode 100644 lisp/leim/.dir-locals.el
 create mode 100644 lisp/obsolete/.dir-locals.el
 create mode 100644 lisp/play/.dir-locals.el

diff --git a/lisp/cedet/.dir-locals.el b/lisp/cedet/.dir-locals.el
new file mode 100644
index 00000000000..de432a4540a
--- /dev/null
+++ b/lisp/cedet/.dir-locals.el
@@ -0,0 +1,4 @@
+;;; Directory Local Variables            -*- no-byte-compile: t -*-
+;;; For more information see (info "(emacs) Directory Variables")
+
+((nil . ((no-byte-compile . t))))
diff --git a/lisp/cedet/data-debug.el b/lisp/cedet/data-debug.el
index 605dc9fa19c..9499b53506c 100644
--- a/lisp/cedet/data-debug.el
+++ b/lisp/cedet/data-debug.el
@@ -1070,3 +1070,7 @@ data-debug-eval-expression
 (provide 'data-debug)
 
 ;;; data-debug.el ends here
+
+;; Local Variables:
+;; no-byte-compile: nil
+;; End:
diff --git a/lisp/cedet/mode-local.el b/lisp/cedet/mode-local.el
index ce37a28c351..74f52ae39d1 100644
--- a/lisp/cedet/mode-local.el
+++ b/lisp/cedet/mode-local.el
@@ -906,3 +906,7 @@ describe-mode-local-bindings-in-mode
 (provide 'mode-local)
 
 ;;; mode-local.el ends here
+
+;; Local Variables:
+;; no-byte-compile: nil
+;; End:
diff --git a/lisp/cedet/pulse.el b/lisp/cedet/pulse.el
index 5b0df013a3c..ce17a7b70f4 100644
--- a/lisp/cedet/pulse.el
+++ b/lisp/cedet/pulse.el
@@ -228,3 +228,7 @@ pulse-line-hook-function
 (provide 'pulse)
 
 ;;; pulse.el ends here
+
+;; Local Variables:
+;; no-byte-compile: nil
+;; End:
diff --git a/lisp/leim/.dir-locals.el b/lisp/leim/.dir-locals.el
new file mode 100644
index 00000000000..de432a4540a
--- /dev/null
+++ b/lisp/leim/.dir-locals.el
@@ -0,0 +1,4 @@
+;;; Directory Local Variables            -*- no-byte-compile: t -*-
+;;; For more information see (info "(emacs) Directory Variables")
+
+((nil . ((no-byte-compile . t))))
diff --git a/lisp/obsolete/.dir-locals.el b/lisp/obsolete/.dir-locals.el
new file mode 100644
index 00000000000..bb7ef238664
--- /dev/null
+++ b/lisp/obsolete/.dir-locals.el
@@ -0,0 +1,4 @@
+;;; Directory Local Variables            -*- no-byte-compile: t -*-
+;;; For more information see (info "(emacs) Directory Variables")
+
+((nil . ((no-native-compile . t))))
diff --git a/lisp/play/.dir-locals.el b/lisp/play/.dir-locals.el
new file mode 100644
index 00000000000..de432a4540a
--- /dev/null
+++ b/lisp/play/.dir-locals.el
@@ -0,0 +1,4 @@
+;;; Directory Local Variables            -*- no-byte-compile: t -*-
+;;; For more information see (info "(emacs) Directory Variables")
+
+((nil . ((no-byte-compile . t))))
-- 
2.38.1

